{"version":3,"sources":["lib/chartjs/controllers/controller.bar.js"],"names":["module","exports","Chart","helpers","defaults","bar","hover","mode","scales","xAxes","type","categoryPercentage","barPercentage","gridLines","offsetGridLines","yAxes","controllers","DatasetController","extend","dataElementType","elements","Rectangle","initialize","chart","datasetIndex","prototype","call","getMeta","getBarCount","me","barCount","each","data","datasets","dataset","meta","getDatasetMeta","isDatasetVisible","update","reset","rectangle","index","updateElement","xScale","getScaleForId","xAxisID","yScale","yAxisID","scaleBase","getBasePixel","rectangleElementOptions","options","custom","getDataset","_xScale","_yScale","_datasetIndex","_index","ruler","getRuler","_model","x","calculateBarX","y","calculateBarY","label","labels","datasetLabel","base","calculateBarBase","width","calculateBarWidth","backgroundColor","getValueAtIndexOrDefault","borderSkipped","borderColor","borderWidth","pivot","stacked","value","Number","i","currentDs","currentDsMeta","id","currentVal","Math","min","max","getPixelForValue","datasetCount","tickWidth","getPixelForTick","ticks","length","categoryWidth","categorySpacing","fullBarWidth","perc","barWidth","barSpacing","barThickness","getBarIndex","barIndex","j","leftTick","isCombo","sumPos","sumNeg","ds","dsMeta","stackedVal","draw","ease","easingDecimal","metaData","len","d","undefined","isNaN","transition","setHoverStyle","model","hoverBackgroundColor","getHoverColor","hoverBorderColor","hoverBorderWidth","removeHoverStyle","horizontalBar","position","tooltips","callbacks","title","tooltipItems","yLabel","tooltipItem","xLabel","height","calculateBarHeight","ctx","_chart","vm","_view","halfHeight","topY","bottomY","right","halfStroke","beginPath","setFillStyle","setStrokeStyle","setLineWidth","corners","borders","startCorner","indexOf","cornerAt","cornerIndex","moveTo","apply","lineTo","fill","stroke","tickHeight","categoryHeight","fullBarHeight","barHeight","topTick"],"mappings":"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","file":"controller.bar.js","sourcesContent":["'use strict';\nmodule.exports = function(Chart) {\n\tvar helpers = Chart.helpers;\n\tChart.defaults.bar = {\n\t\thover: {\n\t\t\tmode: 'label'\n\t\t},\n\t\tscales: {\n\t\t\txAxes: [{\n\t\t\t\ttype: 'category',\n\t\t\t\t// Specific to Bar Controller\n\t\t\t\tcategoryPercentage: 0.8,\n\t\t\t\tbarPercentage: 0.9,\n\t\t\t\t// grid line settings\n\t\t\t\tgridLines: {\n\t\t\t\t\toffsetGridLines: true\n\t\t\t\t}\n\t\t\t}],\n\t\t\tyAxes: [{\n\t\t\t\ttype: 'linear'\n\t\t\t}]\n\t\t}\n\t};\n\tChart.controllers.bar = Chart.DatasetController.extend({\n\t\tdataElementType: Chart.elements.Rectangle,\n\t\tinitialize: function(chart, datasetIndex) {\n\t\t\tChart.DatasetController.prototype.initialize.call(this, chart, datasetIndex);\n\t\t\t// Use this to indicate that this is a bar dataset.\n\t\t\tthis.getMeta().bar = true;\n\t\t},\n\t\t// Get the number of datasets that display bars. We use this to correctly calculate the bar width\n\t\tgetBarCount: function() {\n\t\t\tvar me = this;\n\t\t\tvar barCount = 0;\n\t\t\thelpers.each(me.chart.data.datasets, function(dataset, datasetIndex) {\n\t\t\t\tvar meta = me.chart.getDatasetMeta(datasetIndex);\n\t\t\t\tif (meta.bar && me.chart.isDatasetVisible(datasetIndex)) {\n\t\t\t\t\t++barCount;\n\t\t\t\t}\n\t\t\t}, me);\n\t\t\treturn barCount;\n\t\t},\n\t\tupdate: function(reset) {\n\t\t\tvar me = this;\n\t\t\thelpers.each(me.getMeta().data, function(rectangle, index) {\n\t\t\t\tme.updateElement(rectangle, index, reset);\n\t\t\t}, me);\n\t\t},\n\t\tupdateElement: function(rectangle, index, reset) {\n\t\t\tvar me = this;\n\t\t\tvar meta = me.getMeta();\n\t\t\tvar xScale = me.getScaleForId(meta.xAxisID);\n\t\t\tvar yScale = me.getScaleForId(meta.yAxisID);\n\t\t\tvar scaleBase = yScale.getBasePixel();\n\t\t\tvar rectangleElementOptions = me.chart.options.elements.rectangle;\n\t\t\tvar custom = rectangle.custom || {};\n\t\t\tvar dataset = me.getDataset();\n\t\t\trectangle._xScale = xScale;\n\t\t\trectangle._yScale = yScale;\n\t\t\trectangle._datasetIndex = me.index;\n\t\t\trectangle._index = index;\n\t\t\tvar ruler = me.getRuler(index);\n\t\t\trectangle._model = {\n\t\t\t\tx: me.calculateBarX(index, me.index, ruler),\n\t\t\t\ty: reset ? scaleBase : me.calculateBarY(index, me.index),\n\t\t\t\t// Tooltip\n\t\t\t\tlabel: me.chart.data.labels[index],\n\t\t\t\tdatasetLabel: dataset.label,\n\t\t\t\t// Appearance\n\t\t\t\tbase: reset ? scaleBase : me.calculateBarBase(me.index, index),\n\t\t\t\twidth: me.calculateBarWidth(ruler),\n\t\t\t\tbackgroundColor: custom.backgroundColor ? custom.backgroundColor : helpers.getValueAtIndexOrDefault(dataset.backgroundColor, index, rectangleElementOptions.backgroundColor),\n\t\t\t\tborderSkipped: custom.borderSkipped ? custom.borderSkipped : rectangleElementOptions.borderSkipped,\n\t\t\t\tborderColor: custom.borderColor ? custom.borderColor : helpers.getValueAtIndexOrDefault(dataset.borderColor, index, rectangleElementOptions.borderColor),\n\t\t\t\tborderWidth: custom.borderWidth ? custom.borderWidth : helpers.getValueAtIndexOrDefault(dataset.borderWidth, index, rectangleElementOptions.borderWidth)\n\t\t\t};\n\t\t\trectangle.pivot();\n\t\t},\n\t\tcalculateBarBase: function(datasetIndex, index) {\n\t\t\tvar me = this;\n\t\t\tvar meta = me.getMeta();\n\t\t\tvar yScale = me.getScaleForId(meta.yAxisID);\n\t\t\tvar base = 0;\n\t\t\tif (yScale.options.stacked) {\n\t\t\t\tvar chart = me.chart;\n\t\t\t\tvar datasets = chart.data.datasets;\n\t\t\t\tvar value = Number(datasets[datasetIndex].data[index]);\n\t\t\t\tfor (var i = 0; i < datasetIndex; i++) {\n\t\t\t\t\tvar currentDs = datasets[i];\n\t\t\t\t\tvar currentDsMeta = chart.getDatasetMeta(i);\n\t\t\t\t\tif (currentDsMeta.bar && currentDsMeta.yAxisID === yScale.id && chart.isDatasetVisible(i)) {\n\t\t\t\t\t\tvar currentVal = Number(currentDs.data[index]);\n\t\t\t\t\t\tbase += value < 0 ? Math.min(currentVal, 0) : Math.max(currentVal, 0);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn yScale.getPixelForValue(base);\n\t\t\t}\n\t\t\treturn yScale.getBasePixel();\n\t\t},\n\t\tgetRuler: function(index) {\n\t\t\tvar me = this;\n\t\t\tvar meta = me.getMeta();\n\t\t\tvar xScale = me.getScaleForId(meta.xAxisID);\n\t\t\tvar datasetCount = me.getBarCount();\n\t\t\tvar tickWidth;\n\t\t\tif (xScale.options.type === 'category') {\n\t\t\t\ttickWidth = xScale.getPixelForTick(index + 1) - xScale.getPixelForTick(index);\n\t\t\t} else {\n\t\t\t\t// Average width\n\t\t\t\ttickWidth = xScale.width / xScale.ticks.length;\n\t\t\t}\n\t\t\tvar categoryWidth = tickWidth * xScale.options.categoryPercentage;\n\t\t\tvar categorySpacing = (tickWidth - (tickWidth * xScale.options.categoryPercentage)) / 2;\n\t\t\tvar fullBarWidth = categoryWidth / datasetCount;\n\t\t\tif (xScale.ticks.length !== me.chart.data.labels.length) {\n\t\t\t\tvar perc = xScale.ticks.length / me.chart.data.labels.length;\n\t\t\t\tfullBarWidth = fullBarWidth * perc;\n\t\t\t}\n\t\t\tvar barWidth = fullBarWidth * xScale.options.barPercentage;\n\t\t\tvar barSpacing = fullBarWidth - (fullBarWidth * xScale.options.barPercentage);\n\t\t\treturn {\n\t\t\t\tdatasetCount: datasetCount,\n\t\t\t\ttickWidth: tickWidth,\n\t\t\t\tcategoryWidth: categoryWidth,\n\t\t\t\tcategorySpacing: categorySpacing,\n\t\t\t\tfullBarWidth: fullBarWidth,\n\t\t\t\tbarWidth: barWidth,\n\t\t\t\tbarSpacing: barSpacing\n\t\t\t};\n\t\t},\n\t\tcalculateBarWidth: function(ruler) {\n\t\t\tvar xScale = this.getScaleForId(this.getMeta().xAxisID);\n\t\t\tif (xScale.options.barThickness) {\n\t\t\t\treturn xScale.options.barThickness;\n\t\t\t}\n\t\t\treturn xScale.options.stacked ? ruler.categoryWidth : ruler.barWidth;\n\t\t},\n\t\t// Get bar index from the given dataset index accounting for the fact that not all bars are visible\n\t\tgetBarIndex: function(datasetIndex) {\n\t\t\tvar barIndex = 0;\n\t\t\tvar meta, j;\n\t\t\tfor (j = 0; j < datasetIndex; ++j) {\n\t\t\t\tmeta = this.chart.getDatasetMeta(j);\n\t\t\t\tif (meta.bar && this.chart.isDatasetVisible(j)) {\n\t\t\t\t\t++barIndex;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn barIndex;\n\t\t},\n\t\tcalculateBarX: function(index, datasetIndex, ruler) {\n\t\t\tvar me = this;\n\t\t\tvar meta = me.getMeta();\n\t\t\tvar xScale = me.getScaleForId(meta.xAxisID);\n\t\t\tvar barIndex = me.getBarIndex(datasetIndex);\n\t\t\tvar leftTick = xScale.getPixelForValue(null, index, datasetIndex, me.chart.isCombo);\n\t\t\tleftTick -= me.chart.isCombo ? (ruler.tickWidth / 2) : 0;\n\t\t\tif (xScale.options.stacked) {\n\t\t\t\treturn leftTick + (ruler.categoryWidth / 2) + ruler.categorySpacing;\n\t\t\t}\n\t\t\treturn leftTick +\n\t\t\t\t(ruler.barWidth / 2) +\n\t\t\t\truler.categorySpacing +\n\t\t\t\t(ruler.barWidth * barIndex) +\n\t\t\t\t(ruler.barSpacing / 2) +\n\t\t\t\t(ruler.barSpacing * barIndex);\n\t\t},\n\t\tcalculateBarY: function(index, datasetIndex) {\n\t\t\tvar me = this;\n\t\t\tvar meta = me.getMeta();\n\t\t\tvar yScale = me.getScaleForId(meta.yAxisID);\n\t\t\tvar value = Number(me.getDataset().data[index]);\n\t\t\tif (yScale.options.stacked) {\n\t\t\t\tvar sumPos = 0,\n\t\t\t\t\tsumNeg = 0;\n\t\t\t\tfor (var i = 0; i < datasetIndex; i++) {\n\t\t\t\t\tvar ds = me.chart.data.datasets[i];\n\t\t\t\t\tvar dsMeta = me.chart.getDatasetMeta(i);\n\t\t\t\t\tif (dsMeta.bar && dsMeta.yAxisID === yScale.id && me.chart.isDatasetVisible(i)) {\n\t\t\t\t\t\tvar stackedVal = Number(ds.data[index]);\n\t\t\t\t\t\tif (stackedVal < 0) {\n\t\t\t\t\t\t\tsumNeg += stackedVal || 0;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tsumPos += stackedVal || 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (value < 0) {\n\t\t\t\t\treturn yScale.getPixelForValue(sumNeg + value);\n\t\t\t\t}\n\t\t\t\treturn yScale.getPixelForValue(sumPos + value);\n\t\t\t}\n\t\t\treturn yScale.getPixelForValue(value);\n\t\t},\n\t\tdraw: function(ease) {\n\t\t\tvar me = this;\n\t\t\tvar easingDecimal = ease || 1;\n\t\t\tvar metaData = me.getMeta().data;\n\t\t\tvar dataset = me.getDataset();\n\t\t\tvar i, len;\n\t\t\tfor (i = 0, len = metaData.length; i < len; ++i) {\n\t\t\t\tvar d = dataset.data[i];\n\t\t\t\tif (d !== null && d !== undefined && !isNaN(d)) {\n\t\t\t\t\tmetaData[i].transition(easingDecimal).draw();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tsetHoverStyle: function(rectangle) {\n\t\t\tvar dataset = this.chart.data.datasets[rectangle._datasetIndex];\n\t\t\tvar index = rectangle._index;\n\t\t\tvar custom = rectangle.custom || {};\n\t\t\tvar model = rectangle._model;\n\t\t\tmodel.backgroundColor = custom.hoverBackgroundColor ? custom.hoverBackgroundColor : helpers.getValueAtIndexOrDefault(dataset.hoverBackgroundColor, index, helpers.getHoverColor(model.backgroundColor));\n\t\t\tmodel.borderColor = custom.hoverBorderColor ? custom.hoverBorderColor : helpers.getValueAtIndexOrDefault(dataset.hoverBorderColor, index, helpers.getHoverColor(model.borderColor));\n\t\t\tmodel.borderWidth = custom.hoverBorderWidth ? custom.hoverBorderWidth : helpers.getValueAtIndexOrDefault(dataset.hoverBorderWidth, index, model.borderWidth);\n\t\t},\n\t\tremoveHoverStyle: function(rectangle) {\n\t\t\tvar dataset = this.chart.data.datasets[rectangle._datasetIndex];\n\t\t\tvar index = rectangle._index;\n\t\t\tvar custom = rectangle.custom || {};\n\t\t\tvar model = rectangle._model;\n\t\t\tvar rectangleElementOptions = this.chart.options.elements.rectangle;\n\t\t\tmodel.backgroundColor = custom.backgroundColor ? custom.backgroundColor : helpers.getValueAtIndexOrDefault(dataset.backgroundColor, index, rectangleElementOptions.backgroundColor);\n\t\t\tmodel.borderColor = custom.borderColor ? custom.borderColor : helpers.getValueAtIndexOrDefault(dataset.borderColor, index, rectangleElementOptions.borderColor);\n\t\t\tmodel.borderWidth = custom.borderWidth ? custom.borderWidth : helpers.getValueAtIndexOrDefault(dataset.borderWidth, index, rectangleElementOptions.borderWidth);\n\t\t}\n\t});\n\t// including horizontalBar in the bar file, instead of a file of its own\n\t// it extends bar (like pie extends doughnut)\n\tChart.defaults.horizontalBar = {\n\t\thover: {\n\t\t\tmode: 'label'\n\t\t},\n\t\tscales: {\n\t\t\txAxes: [{\n\t\t\t\ttype: 'linear',\n\t\t\t\tposition: 'bottom'\n\t\t\t}],\n\t\t\tyAxes: [{\n\t\t\t\tposition: 'left',\n\t\t\t\ttype: 'category',\n\t\t\t\t// Specific to Horizontal Bar Controller\n\t\t\t\tcategoryPercentage: 0.8,\n\t\t\t\tbarPercentage: 0.9,\n\t\t\t\t// grid line settings\n\t\t\t\tgridLines: {\n\t\t\t\t\toffsetGridLines: true\n\t\t\t\t}\n\t\t\t}]\n\t\t},\n\t\telements: {\n\t\t\trectangle: {\n\t\t\t\tborderSkipped: 'left'\n\t\t\t}\n\t\t},\n\t\ttooltips: {\n\t\t\tcallbacks: {\n\t\t\t\ttitle: function(tooltipItems, data) {\n\t\t\t\t\t// Pick first xLabel for now\n\t\t\t\t\tvar title = '';\n\t\t\t\t\tif (tooltipItems.length > 0) {\n\t\t\t\t\t\tif (tooltipItems[0].yLabel) {\n\t\t\t\t\t\t\ttitle = tooltipItems[0].yLabel;\n\t\t\t\t\t\t} else if (data.labels.length > 0 && tooltipItems[0].index < data.labels.length) {\n\t\t\t\t\t\t\ttitle = data.labels[tooltipItems[0].index];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn title;\n\t\t\t\t},\n\t\t\t\tlabel: function(tooltipItem, data) {\n\t\t\t\t\tvar datasetLabel = data.datasets[tooltipItem.datasetIndex].label || '';\n\t\t\t\t\treturn datasetLabel + ': ' + tooltipItem.xLabel;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\tChart.controllers.horizontalBar = Chart.controllers.bar.extend({\n\t\tupdateElement: function(rectangle, index, reset) {\n\t\t\tvar me = this;\n\t\t\tvar meta = me.getMeta();\n\t\t\tvar xScale = me.getScaleForId(meta.xAxisID);\n\t\t\tvar yScale = me.getScaleForId(meta.yAxisID);\n\t\t\tvar scaleBase = xScale.getBasePixel();\n\t\t\tvar custom = rectangle.custom || {};\n\t\t\tvar dataset = me.getDataset();\n\t\t\tvar rectangleElementOptions = me.chart.options.elements.rectangle;\n\t\t\trectangle._xScale = xScale;\n\t\t\trectangle._yScale = yScale;\n\t\t\trectangle._datasetIndex = me.index;\n\t\t\trectangle._index = index;\n\t\t\tvar ruler = me.getRuler(index);\n\t\t\trectangle._model = {\n\t\t\t\tx: reset ? scaleBase : me.calculateBarX(index, me.index),\n\t\t\t\ty: me.calculateBarY(index, me.index, ruler),\n\t\t\t\t// Tooltip\n\t\t\t\tlabel: me.chart.data.labels[index],\n\t\t\t\tdatasetLabel: dataset.label,\n\t\t\t\t// Appearance\n\t\t\t\tbase: reset ? scaleBase : me.calculateBarBase(me.index, index),\n\t\t\t\theight: me.calculateBarHeight(ruler),\n\t\t\t\tbackgroundColor: custom.backgroundColor ? custom.backgroundColor : helpers.getValueAtIndexOrDefault(dataset.backgroundColor, index, rectangleElementOptions.backgroundColor),\n\t\t\t\tborderSkipped: custom.borderSkipped ? custom.borderSkipped : rectangleElementOptions.borderSkipped,\n\t\t\t\tborderColor: custom.borderColor ? custom.borderColor : helpers.getValueAtIndexOrDefault(dataset.borderColor, index, rectangleElementOptions.borderColor),\n\t\t\t\tborderWidth: custom.borderWidth ? custom.borderWidth : helpers.getValueAtIndexOrDefault(dataset.borderWidth, index, rectangleElementOptions.borderWidth)\n\t\t\t};\n\t\t\trectangle.draw = function() {\n\t\t\t\tvar ctx = this._chart.ctx;\n\t\t\t\tvar vm = this._view;\n\t\t\t\tvar halfHeight = vm.height / 2,\n\t\t\t\t\ttopY = vm.y - halfHeight,\n\t\t\t\t\tbottomY = vm.y + halfHeight,\n\t\t\t\t\tright = vm.base - (vm.base - vm.x),\n\t\t\t\t\thalfStroke = vm.borderWidth / 2;\n\t\t\t\t// Canvas doesn't allow us to stroke inside the width so we can\n\t\t\t\t// adjust the sizes to fit if we're setting a stroke on the line\n\t\t\t\tif (vm.borderWidth) {\n\t\t\t\t\ttopY += halfStroke;\n\t\t\t\t\tbottomY -= halfStroke;\n\t\t\t\t\tright += halfStroke;\n\t\t\t\t}\n\t\t\t\tctx.beginPath();\n\t\t\t\tctx.setFillStyle(vm.backgroundColor);\n\t\t\t\tctx.setStrokeStyle(vm.borderColor);\n\t\t\t\tctx.setLineWidth(vm.borderWidth);\n\t\t\t\t// Corner points, from bottom-left to bottom-right clockwise\n\t\t\t\t// | 1 2 |\n\t\t\t\t// | 0 3 |\n\t\t\t\tvar corners = [\n\t\t\t\t\t[vm.base, bottomY],\n\t\t\t\t\t[vm.base, topY],\n\t\t\t\t\t[right, topY],\n\t\t\t\t\t[right, bottomY]\n\t\t\t\t];\n\t\t\t\t// Find first (starting) corner with fallback to 'bottom'\n\t\t\t\tvar borders = ['bottom', 'left', 'top', 'right'];\n\t\t\t\tvar startCorner = borders.indexOf(vm.borderSkipped, 0);\n\t\t\t\tif (startCorner === -1) {\n\t\t\t\t\tstartCorner = 0;\n\t\t\t\t}\n\t\t\t\tfunction cornerAt(cornerIndex) {\n\t\t\t\t\treturn corners[(startCorner + cornerIndex) % 4];\n\t\t\t\t}\n\t\t\t\t// Draw rectangle from 'startCorner'\n\t\t\t\tctx.moveTo.apply(ctx, cornerAt(0));\n\t\t\t\tfor (var i = 1; i < 4; i++) {\n\t\t\t\t\tctx.lineTo.apply(ctx, cornerAt(i));\n\t\t\t\t}\n\t\t\t\tctx.fill();\n\t\t\t\tif (vm.borderWidth) {\n\t\t\t\t\tctx.stroke();\n\t\t\t\t}\n\t\t\t};\n\t\t\trectangle.pivot();\n\t\t},\n\t\tcalculateBarBase: function(datasetIndex, index) {\n\t\t\tvar me = this;\n\t\t\tvar meta = me.getMeta();\n\t\t\tvar xScale = me.getScaleForId(meta.xAxisID);\n\t\t\tvar base = 0;\n\t\t\tif (xScale.options.stacked) {\n\t\t\t\tvar chart = me.chart;\n\t\t\t\tvar datasets = chart.data.datasets;\n\t\t\t\tvar value = Number(datasets[datasetIndex].data[index]);\n\t\t\t\tfor (var i = 0; i < datasetIndex; i++) {\n\t\t\t\t\tvar currentDs = datasets[i];\n\t\t\t\t\tvar currentDsMeta = chart.getDatasetMeta(i);\n\t\t\t\t\tif (currentDsMeta.bar && currentDsMeta.xAxisID === xScale.id && chart.isDatasetVisible(i)) {\n\t\t\t\t\t\tvar currentVal = Number(currentDs.data[index]);\n\t\t\t\t\t\tbase += value < 0 ? Math.min(currentVal, 0) : Math.max(currentVal, 0);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn xScale.getPixelForValue(base);\n\t\t\t}\n\t\t\treturn xScale.getBasePixel();\n\t\t},\n\t\tgetRuler: function(index) {\n\t\t\tvar me = this;\n\t\t\tvar meta = me.getMeta();\n\t\t\tvar yScale = me.getScaleForId(meta.yAxisID);\n\t\t\tvar datasetCount = me.getBarCount();\n\t\t\tvar tickHeight;\n\t\t\tif (yScale.options.type === 'category') {\n\t\t\t\ttickHeight = yScale.getPixelForTick(index + 1) - yScale.getPixelForTick(index);\n\t\t\t} else {\n\t\t\t\t// Average width\n\t\t\t\ttickHeight = yScale.width / yScale.ticks.length;\n\t\t\t}\n\t\t\tvar categoryHeight = tickHeight * yScale.options.categoryPercentage;\n\t\t\tvar categorySpacing = (tickHeight - (tickHeight * yScale.options.categoryPercentage)) / 2;\n\t\t\tvar fullBarHeight = categoryHeight / datasetCount;\n\t\t\tif (yScale.ticks.length !== me.chart.data.labels.length) {\n\t\t\t\tvar perc = yScale.ticks.length / me.chart.data.labels.length;\n\t\t\t\tfullBarHeight = fullBarHeight * perc;\n\t\t\t}\n\t\t\tvar barHeight = fullBarHeight * yScale.options.barPercentage;\n\t\t\tvar barSpacing = fullBarHeight - (fullBarHeight * yScale.options.barPercentage);\n\t\t\treturn {\n\t\t\t\tdatasetCount: datasetCount,\n\t\t\t\ttickHeight: tickHeight,\n\t\t\t\tcategoryHeight: categoryHeight,\n\t\t\t\tcategorySpacing: categorySpacing,\n\t\t\t\tfullBarHeight: fullBarHeight,\n\t\t\t\tbarHeight: barHeight,\n\t\t\t\tbarSpacing: barSpacing\n\t\t\t};\n\t\t},\n\t\tcalculateBarHeight: function(ruler) {\n\t\t\tvar me = this;\n\t\t\tvar yScale = me.getScaleForId(me.getMeta().yAxisID);\n\t\t\tif (yScale.options.barThickness) {\n\t\t\t\treturn yScale.options.barThickness;\n\t\t\t}\n\t\t\treturn yScale.options.stacked ? ruler.categoryHeight : ruler.barHeight;\n\t\t},\n\t\tcalculateBarX: function(index, datasetIndex) {\n\t\t\tvar me = this;\n\t\t\tvar meta = me.getMeta();\n\t\t\tvar xScale = me.getScaleForId(meta.xAxisID);\n\t\t\tvar value = Number(me.getDataset().data[index]);\n\t\t\tif (xScale.options.stacked) {\n\t\t\t\tvar sumPos = 0,\n\t\t\t\t\tsumNeg = 0;\n\t\t\t\tfor (var i = 0; i < datasetIndex; i++) {\n\t\t\t\t\tvar ds = me.chart.data.datasets[i];\n\t\t\t\t\tvar dsMeta = me.chart.getDatasetMeta(i);\n\t\t\t\t\tif (dsMeta.bar && dsMeta.xAxisID === xScale.id && me.chart.isDatasetVisible(i)) {\n\t\t\t\t\t\tvar stackedVal = Number(ds.data[index]);\n\t\t\t\t\t\tif (stackedVal < 0) {\n\t\t\t\t\t\t\tsumNeg += stackedVal || 0;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tsumPos += stackedVal || 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (value < 0) {\n\t\t\t\t\treturn xScale.getPixelForValue(sumNeg + value);\n\t\t\t\t}\n\t\t\t\treturn xScale.getPixelForValue(sumPos + value);\n\t\t\t}\n\t\t\treturn xScale.getPixelForValue(value);\n\t\t},\n\t\tcalculateBarY: function(index, datasetIndex, ruler) {\n\t\t\tvar me = this;\n\t\t\tvar meta = me.getMeta();\n\t\t\tvar yScale = me.getScaleForId(meta.yAxisID);\n\t\t\tvar barIndex = me.getBarIndex(datasetIndex);\n\t\t\tvar topTick = yScale.getPixelForValue(null, index, datasetIndex, me.chart.isCombo);\n\t\t\ttopTick -= me.chart.isCombo ? (ruler.tickHeight / 2) : 0;\n\t\t\tif (yScale.options.stacked) {\n\t\t\t\treturn topTick + (ruler.categoryHeight / 2) + ruler.categorySpacing;\n\t\t\t}\n\t\t\treturn topTick +\n\t\t\t\t(ruler.barHeight / 2) +\n\t\t\t\truler.categorySpacing +\n\t\t\t\t(ruler.barHeight * barIndex) +\n\t\t\t\t(ruler.barSpacing / 2) +\n\t\t\t\t(ruler.barSpacing * barIndex);\n\t\t}\n\t});\n};\n"]}