{"version":3,"sources":["lib/chartjs/core/core.title.js"],"names":["module","exports","Chart","helpers","defaults","global","title","display","position","fullWidth","fontStyle","padding","text","noop","Title","Element","extend","initialize","config","me","options","configMerge","legendHitBoxes","beforeUpdate","chartOpts","chart","update","maxWidth","maxHeight","margins","beforeSetDimensions","setDimensions","afterSetDimensions","beforeBuildLabels","buildLabels","afterBuildLabels","beforeFit","fit","afterFit","afterUpdate","minSize","isHorizontal","width","left","right","height","top","bottom","paddingLeft","paddingTop","paddingRight","paddingBottom","valueOrDefault","getValueOrDefault","opts","globalDefaults","fontSize","defaultFontSize","pos","draw","ctx","defaultFontStyle","fontFamily","defaultFontFamily","titleFont","fontString","rotation","titleX","titleY","setFillStyle","fontColor","defaultFontColor","font","setFontSize","Math","PI","save","translate","rotate","textAlign","textBaseline","lgText","replace","length","fillText","restore","plugins","register","beforeInit","chartInstance","titleOpts","titleBlock","layoutService","addBox"],"mappings":"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","file":"core.title.js","sourcesContent":["'use strict';\nmodule.exports = function(Chart) {\n\tvar helpers = Chart.helpers;\n\tChart.defaults.global.title = {\n\t\tdisplay: false,\n\t\tposition: 'top',\n\t\tfullWidth: true, // marks that this box should take the full width of the canvas (pushing down other boxes)\n\t\tfontStyle: 'bold',\n\t\tpadding: 10,\n\t\t// actual title\n\t\ttext: ''\n\t};\n\tvar noop = helpers.noop;\n\tChart.Title = Chart.Element.extend({\n\t\tinitialize: function(config) {\n\t\t\tvar me = this;\n\t\t\thelpers.extend(me, config);\n\t\t\tme.options = helpers.configMerge(Chart.defaults.global.title, config.options);\n\t\t\t// Contains hit boxes for each dataset (in dataset order)\n\t\t\tme.legendHitBoxes = [];\n\t\t},\n\t\t// These methods are ordered by lifecycle. Utilities then follow.\n\t\tbeforeUpdate: function() {\n\t\t\tvar chartOpts = this.chart.options;\n\t\t\tif (chartOpts && chartOpts.title) {\n\t\t\t\tthis.options = helpers.configMerge(Chart.defaults.global.title, chartOpts.title);\n\t\t\t}\n\t\t},\n\t\tupdate: function(maxWidth, maxHeight, margins) {\n\t\t\tvar me = this;\n\t\t\t// Update Lifecycle - Probably don't want to ever extend or overwrite this function ;)\n\t\t\tme.beforeUpdate();\n\t\t\t// Absorb the master measurements\n\t\t\tme.maxWidth = maxWidth;\n\t\t\tme.maxHeight = maxHeight;\n\t\t\tme.margins = margins;\n\t\t\t// Dimensions\n\t\t\tme.beforeSetDimensions();\n\t\t\tme.setDimensions();\n\t\t\tme.afterSetDimensions();\n\t\t\t// Labels\n\t\t\tme.beforeBuildLabels();\n\t\t\tme.buildLabels();\n\t\t\tme.afterBuildLabels();\n\t\t\t// Fit\n\t\t\tme.beforeFit();\n\t\t\tme.fit();\n\t\t\tme.afterFit();\n\t\t\t//\n\t\t\tme.afterUpdate();\n\t\t\treturn me.minSize;\n\t\t},\n\t\tafterUpdate: noop,\n\t\t//\n\t\tbeforeSetDimensions: noop,\n\t\tsetDimensions: function() {\n\t\t\tvar me = this;\n\t\t\t// Set the unconstrained dimension before label rotation\n\t\t\tif (me.isHorizontal()) {\n\t\t\t\t// Reset position before calculating rotation\n\t\t\t\tme.width = me.maxWidth;\n\t\t\t\tme.left = 0;\n\t\t\t\tme.right = me.width;\n\t\t\t} else {\n\t\t\t\tme.height = me.maxHeight;\n\t\t\t\t// Reset position before calculating rotation\n\t\t\t\tme.top = 0;\n\t\t\t\tme.bottom = me.height;\n\t\t\t}\n\t\t\t// Reset padding\n\t\t\tme.paddingLeft = 0;\n\t\t\tme.paddingTop = 0;\n\t\t\tme.paddingRight = 0;\n\t\t\tme.paddingBottom = 0;\n\t\t\t// Reset minSize\n\t\t\tme.minSize = {\n\t\t\t\twidth: 0,\n\t\t\t\theight: 0\n\t\t\t};\n\t\t},\n\t\tafterSetDimensions: noop,\n\t\t//\n\t\tbeforeBuildLabels: noop,\n\t\tbuildLabels: noop,\n\t\tafterBuildLabels: noop,\n\t\t//\n\t\tbeforeFit: noop,\n\t\tfit: function() {\n\t\t\tvar me = this,\n\t\t\t\tvalueOrDefault = helpers.getValueOrDefault,\n\t\t\t\topts = me.options,\n\t\t\t\tglobalDefaults = Chart.defaults.global,\n\t\t\t\tdisplay = opts.display,\n\t\t\t\tfontSize = valueOrDefault(opts.fontSize, globalDefaults.defaultFontSize),\n\t\t\t\tminSize = me.minSize;\n\t\t\tif (me.isHorizontal()) {\n\t\t\t\tminSize.width = me.maxWidth; // fill all the width\n\t\t\t\tminSize.height = display ? fontSize + (opts.padding * 2) : 0;\n\t\t\t} else {\n\t\t\t\tminSize.width = display ? fontSize + (opts.padding * 2) : 0;\n\t\t\t\tminSize.height = me.maxHeight; // fill all the height\n\t\t\t}\n\t\t\tme.width = minSize.width;\n\t\t\tme.height = minSize.height;\n\t\t},\n\t\tafterFit: noop,\n\t\t// Shared Methods\n\t\tisHorizontal: function() {\n\t\t\tvar pos = this.options.position;\n\t\t\treturn pos === 'top' || pos === 'bottom';\n\t\t},\n\t\t// Actually draw the title block on the canvas\n\t\tdraw: function() {\n\t\t\tvar me = this,\n\t\t\t\tctx = me.ctx,\n\t\t\t\tvalueOrDefault = helpers.getValueOrDefault,\n\t\t\t\topts = me.options,\n\t\t\t\tglobalDefaults = Chart.defaults.global;\n\t\t\tif (opts.display) {\n\t\t\t\tvar fontSize = valueOrDefault(opts.fontSize, globalDefaults.defaultFontSize),\n\t\t\t\t\tfontStyle = valueOrDefault(opts.fontStyle, globalDefaults.defaultFontStyle),\n\t\t\t\t\tfontFamily = valueOrDefault(opts.fontFamily, globalDefaults.defaultFontFamily),\n\t\t\t\t\ttitleFont = helpers.fontString(fontSize, fontStyle, fontFamily),\n\t\t\t\t\trotation = 0,\n\t\t\t\t\ttitleX,\n\t\t\t\t\ttitleY,\n\t\t\t\t\ttop = me.top,\n\t\t\t\t\tleft = me.left,\n\t\t\t\t\tbottom = me.bottom,\n\t\t\t\t\tright = me.right,\n\t\t\t\t\tmaxWidth;\n\t\t\t\tctx.setFillStyle(valueOrDefault(opts.fontColor, globalDefaults.defaultFontColor)); // render in correct colour\n\t\t\t\tctx.font = titleFont;\n\t\t\t\tctx.setFontSize(fontSize);\n\t\t\t\t// Horizontal\n\t\t\t\tif (me.isHorizontal()) {\n\t\t\t\t\ttitleX = left + ((right - left) / 2); // midpoint of the width\n\t\t\t\t\ttitleY = top + ((bottom - top) / 2); // midpoint of the height\n\t\t\t\t\tmaxWidth = right - left;\n\t\t\t\t} else {\n\t\t\t\t\ttitleX = opts.position === 'left' ? left + (fontSize / 2) : right - (fontSize / 2);\n\t\t\t\t\ttitleY = top + ((bottom - top) / 2);\n\t\t\t\t\tmaxWidth = bottom - top;\n\t\t\t\t\trotation = Math.PI * (opts.position === 'left' ? -0.5 : 0.5);\n\t\t\t\t}\n\t\t\t\tctx.save();\n\t\t\t\tctx.translate(titleX, titleY);\n\t\t\t\tctx.rotate(rotation);\n\t\t\t\tctx.textAlign = 'center';\n\t\t\t\tctx.textBaseline = 'middle';\n\t\t\t\tvar lgText=-2.9*((opts.text+'').replace(/[^\\x00-\\xff]/g, \"**\").length);//todo\n\t\t\t\tctx.fillText(opts.text, lgText, 0, maxWidth);//todo 标题往左偏一点\n\t\t\t\tctx.restore();\n\t\t\t}\n\t\t}\n\t});\n\t// Register the title plugin\n\tChart.plugins.register({\n\t\tbeforeInit: function(chartInstance) {\n\t\t\tvar opts = chartInstance.options;\n\t\t\tvar titleOpts = opts.title;\n\t\t\tif (titleOpts) {\n\t\t\t\tchartInstance.titleBlock = new Chart.Title({\n\t\t\t\t\tctx: chartInstance.chart.ctx,\n\t\t\t\t\toptions: titleOpts,\n\t\t\t\t\tchart: chartInstance\n\t\t\t\t});\n\t\t\t\tChart.layoutService.addBox(chartInstance, chartInstance.titleBlock);\n\t\t\t}\n\t\t}\n\t});\n};\n"]}